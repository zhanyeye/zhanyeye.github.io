---
title: linux 基本操作
mathjax: true
date: 2019-11-28 14:50:41
tags:
categories:
---

内容来自[实验楼](https://www.shiyanlou.com/)

##### 快捷操作

######  常用组合快捷键 

| 快捷键         | 说明                                                       |
| -------------- | ---------------------------------------------------------- |
| `Ctrl+c`       | 中断操作                                                   |
| `Ctrl+d`       | 键盘输入结束或退出终端                                     |
| `Ctrl+s`       | 暂停当前程序，暂停后按下任意键恢复运行                     |
| `Ctrl+a`       | 将光标移动到命令行首                                       |
| `Ctrl+e`       | 将光标移动到命令行尾                                       |
| `Ctrl+l`       | 清屏                                                       |
| `Ctrl+shift+N` | 新建终端窗口（在实验环境中，此命令可能与浏览器快捷键冲突） |

<!--more-->

#####  环境变量 

 和 Windows 系统相似，在安装许多软件的时候需要配置环境变量。同样，在 Linux 里也需要配置相应的环境变量。Linux 中的环境变量主要分为**系统级**和**用户级**

+ 系统级环境变量是每个登录到系统的用户都要读取的变量。
+ 户级的环境变量则是用户使用系统时加载的个人环境变量。 

- **系统级**
  - `/etc/profile` 文件：当用户登录 Shell 时执行的第一个文件，用来完成一些初始化工作，通常是调用 `/etc/bash.bashrc` 文件来完成具体工作。
  - `/etc/environment` 文件：系统级别的环境变量，并不是一个脚本，内容为一些环境变量赋值语句，用来给不从 Shell 启动的程序设置环境变量。
- **用户级**（文件主要是在 `/home` 目录下）
  - `~/.profile`：每个用户都可以调用来输入自己使用的 `shell` 信息，不过在用户登录时，该文件只执行一次。
  - `~/.bashrc`： 包含登录用户的专用 `bash shell` 的 `bash` 信息。也就是说每开一个 `shell`，该文件都会被读取一次。
- **临时的**
  - 针对当前 `shell` 的环境变量。

**简单来说，环境变量就是指定一个目录，软件在运行的时候，相关程序会按照该目录来查找相关文件。**

例如，在默认情况下，一个进程被创建时，除了创建过程会被明确指定，它也将继承其父进程的绝大部分环境设置。如图所示：(**环境变量会继承，而普通变量 不会**)

<img width="400" src="https://raw.githubusercontent.com/zhanyeye/Figure-bed/win-pic/img/20191128104742.png">

###### Linux 变量的种类

前面知道可以从系统和用户级来划分环境变量。 若按照**变量的生存周期**来划分，那么变量就可以分为：

- **永久的**：需要修改配置文件，变量永久生效。(eg : 在`/etc/profile `文件中添加export PATH=$PATH:/new)
- **临时的**：使用 `export` 命令来声明即可，变量在关闭 `shell` 的时候自动失效。

若按照**环境变量自身的信息**来划分，则可以分为：

- 当前 `shell` 进程私有用户自定义变量。此时变量只在当前 `shell` 中有效。
- `shell` 自身的內建变量。
- 从自定义变量导出的环境变量。

###### 设置变量的方法

+ **/etc/profile 文件中添加变量（永久的）**

  > 用 vim 编辑器编辑 `/etc/profile` 文件来增加变量，将作用于 Linux 下所有用户，且具有永久性。（**此方法谨慎使用！**） 

+ **修改 ~/.profile 文件（对单一用户生效(永久的)）**

  >  这种方法较为安全，可以把使用这些环境变量的权限控制到用户级别，主要是针对某一特定的用户，如果需要给某个用户权限使用这些环境变量，只需要修改其个人用户主目录下的 `.profile` 文件就可以了。 

+ **直接运行`export`命令定义环境变量（临时的）**

  >  在控制台中设置，不赞成这种方式，这种设置只对**当前的 shell** 起作用，换一个 shell 设置就无效了。 在 shell 的命令行下直接使用 [**export 变量名=变量值**] 来定义变量。 

 在每个用户的 `home`目录中有一个 Shell 每次启动时会默认执行一个配置脚本，以初始化环境，包括添加一些用户自定义环境变量等等。`zsh` 的配置文件是 `.zshrc`，相应 `Bash` 的配置文件为 `.bashrc` 。它们在 etc 下还都有一个或多个全局的配置文件，不过我们一般只修改用户目录下的配置文件。 

**eg** : 添加一个自定义的变量

```bash
$ export shiyanlou="shiyanlou001"
$ echo $shiyanlou
```

 注：使用 `echo` 输出变量时需要在变量名前面加 `$` 符号 

######  环境变量的查看 

+ **export 命令查看**

  > 1. 用来显示从 Shell 中导出成环境变量的变量`export`
  > 2. 也能通过它将自定义变量导出为环境变量。eg:`export  temp='test'` 

  ```zsh
  $ cd ~
  $ temp=shiyanlou
  $ echo $temp
  shiyanlou   
  $ zsh    # 创建子进程，实验楼环境使用的是 zsh 
  $ echo $temp
           # 变量不存在
  $ exit 
  $ export temp
  $ zsh
  $ echo $temp 
  shiyanlou 
  ```

+ **env 命令查看所有的环境变量**

  >  可以用来显示与当前用户相关的环境变量，还可以让命令在指定环境中运行。 

+ **set 命令查看本地定义的环境变量**

  >  可以用来显示**当前 Shell** 中的所有变量，包括其内建环境变量（与 Shell 外观等相关）、用户自定义变量及导出的环境变量。 

+ **使用`vimdiff`直观查看环境变量**

  对于刚才讲到的三种环境变量的查看 ：`export`、`env`、`set` 我们还可以通过 `vimdiff` 工具来直观的比较它们之间的差别：

  ```zsh
  $ temp=shiyanlou
  $ export temp_env=shiyanlou
  $ env|sort>env.txt
  $ export|sort>export.txt
  $ set|sort>set.txt
  ```

  命令的输出是用到了管道`|` 和用`sort`命令来排序，将文本文件重定向。

  ```zsh
  $ vimdiff env.txt export.txt set.txt
  ```

+ **修改和删除环境变量**

  **修改环境变量**

  变量的修改有以下几种方式：

  | 变量设置方式                   | 说明                                         |
  | ------------------------------ | -------------------------------------------- |
  | `${变量名#匹配字串}`           | 从头向后开始匹配，删除符合匹配字串的最短数据 |
  | `${变量名##匹配字串}`          | 从头向后开始匹配，删除符合匹配字串的最长数据 |
  | `${变量名%匹配字串}`           | 从尾向前开始匹配，删除符合匹配字串的最短数据 |
  | `${变量名%%匹配字串}`          | 从尾向前开始匹配，删除符合匹配字串的最长数据 |
  | `${变量名/旧的字串/新的字串}`  | 将符合旧字串的第一个字串替换为新的字串       |
  | `${变量名//旧的字串/新的字串}` | 将符合旧字串的全部字串替换为新的字串         |

  可以通过下面的操作来临时修改 PATH 环境变量，该修改仅对当前进程有效：

  ```bash
  $ PATH=$PATH:/home/shiyanlou/mybin
  $ echo $PATH
  $ PATH=${PATH%:/home/shiyanlou/mybin}
  $ echo $PATH
  ```

  **删除环境变量**

  `unset` 可以用来删除指定的环境变量

  ```
  $ unset temp
  ```

###### 环境变量的生效

`source` 命令可以读取并执行指定文件中的命令，这里我们可以通过该命令来让配置的文件立即生效，避免了每次修改配置脚本文件后，还需要退出终端甚至重启之后才能生效的问题。

```
$ echo "PATH=$PATH:/home/shiyanlou/mybin" >> .zshrc
$ source .zshrc
$ echo $PATH
```

注：`.zshrc` 是 home 目录下的 zsh 的配置文件（实验环境中的 shell 是 zsh，ubuntu默认的 shell 是 bash）。

###### 常用的环境变量

| 环境变量   | 说明                                             |
| ---------- | ------------------------------------------------ |
| `PATH`     | 决定了 shell 将到哪些目录中寻找命令或程序        |
| `HOME`     | 当前用户主目录                                   |
| `HISTSIZE` | 历史记录数                                       |
| `LOGNAME`  | 当前用户的登录名                                 |
| `HOSTNAME` | 指主机的名称                                     |
| `SHELL`    | 当前用户 Shell 类型                              |
| `LANGUGE`  | 语言相关的环境变量，多语言可以修改此环境变量     |
| `MAIL`     | 当前用户的邮件存放目录                           |
| `PS1`      | 基本提示符，对于 root 用户是 #，对于普通用户是 $ |